@model ForgotPasswordViewModel
@{
    ViewData["Title"] = "Mot de passe oublié";
}

<div class="forgot-password-page">
    <div class="container-fluid py-5">
        <div class="row justify-content-center min-vh-75 align-items-center">
            <div class="col-lg-5 col-md-7">
                <!-- Carte de mot de passe oublié -->
                <div class="card border-0 shadow-lg animate__animated animate__fadeInUp">
                    <div class="card-header bg-gradient text-white p-4 text-center" style="background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);">
                        <div class="mb-3">
                            <i class="fas fa-key fa-3x text-white"></i>
                        </div>
                        <h3 class="mb-1 fw-bold">Mot de Passe Oublié</h3>
                        <p class="mb-0 opacity-75">Récupération de votre compte</p>
                    </div>
                    
                    <div class="card-body p-5">
                        @if (TempData["Success"] != null)
                        {
                            <div class="alert alert-success border-0 mb-4 animate__animated animate__fadeInUp">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle fa-lg me-3"></i>
                                    <div>
                                        @TempData["Success"]
                                    </div>
                                </div>
                            </div>
                        }
                        
                        @if (TempData["Error"] != null)
                        {
                            <div class="alert alert-danger border-0 mb-4 animate__animated animate__fadeInUp">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-exclamation-triangle fa-lg me-3"></i>
                                    <div>
                                        @TempData["Error"]
                                    </div>
                                </div>
                            </div>
                        }

                        @if (TempData["Message"] != null)
                        {
                            <div class="alert alert-@(TempData["MessageType"] ?? "info") border-0 mb-4 animate__animated animate__fadeInUp">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-info-circle fa-lg me-3"></i>
                                    <div>
                                        @TempData["Message"]
                                    </div>
                                </div>
                            </div>
                        }
                        
                        <!-- Instructions -->
                        <div class="alert alert-info border-0 mb-4 animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                            <h6 class="alert-heading">
                                <i class="fas fa-lightbulb me-2"></i>Comment ça fonctionne
                            </h6>
                            <ol class="mb-0">
                                <li>Saisissez votre adresse email ci-dessous</li>
                                <li>Nous vérifierons si le compte existe</li>
                                <li>Un code de vérification sera envoyé par email</li>
                                <li>Utilisez ce code pour créer un nouveau mot de passe</li>
                            </ol>
                        </div>
                        
                        <form asp-action="ForgotPassword" method="post" class="needs-validation" novalidate>
                            <div asp-validation-summary="ModelOnly" class="alert alert-danger border-0 mb-4"></div>
                            
                            <!-- Champ Email -->
                            <div class="form-floating mb-4 animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
                                <input asp-for="Email" class="form-control" placeholder="Email" type="email" required autofocus />
                                <label asp-for="Email" class="form-label">
                                    <i class="fas fa-envelope me-2"></i>Adresse email de votre compte
                                </label>
                                <span asp-validation-for="Email" class="text-danger"></span>
                                <div class="form-text">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Saisissez l'email associé à votre compte FNZ ChatBot
                                </div>
                            </div>
                            
                            <!-- Bouton d'envoi -->
                            <div class="d-grid mb-4 animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
                                <button type="submit" class="btn btn-warning btn-lg">
                                    <i class="fas fa-paper-plane me-2"></i>Envoyer le code de vérification
                                </button>
                            </div>
                        </form>
                        
                        <!-- Séparateur -->
                        <hr class="my-4">
                        
                        <!-- Liens utiles -->
                        <div class="text-center animate__animated animate__fadeInUp" style="animation-delay: 0.4s;">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <a href="@Url.Action("Login")" class="btn btn-outline-primary w-100">
                                        <i class="fas fa-arrow-left me-2"></i>Retour à la connexion
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <a href="@Url.Action("ResetPassword")" class="btn btn-outline-secondary w-100">
                                        <i class="fas fa-key me-2"></i>J'ai déjà un code
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Aide -->
                        <div class="mt-4 animate__animated animate__fadeInUp" style="animation-delay: 0.5s;">
                            <div class="card border-0 bg-light">
                                <div class="card-body p-3 text-center">
                                    <h6 class="text-muted mb-2">
                                        <i class="fas fa-question-circle me-2"></i>Besoin d'aide ?
                                    </h6>
                                    <p class="mb-0 text-muted small">
                                        Si vous ne recevez pas l'email ou rencontrez des difficultés,<br>
                                        contactez l'équipe support : <a href="mailto:admin@fnz.tn" class="text-primary">admin@fnz.tn</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Footer de la page -->
                <div class="text-center mt-4 animate__animated animate__fadeInUp" style="animation-delay: 0.6s;">
                    <p class="text-muted mb-0">
                        <i class="fas fa-shield-alt me-2"></i>
                        Processus sécurisé - Vos données sont protégées
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Validation du formulaire
            const form = document.querySelector('.needs-validation');
            if (form) {
                form.addEventListener('submit', function(event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                });
            }
            
            // Animation des champs au focus
            const formControls = document.querySelectorAll('.form-control');
            formControls.forEach(control => {
                control.addEventListener('focus', function() {
                    this.parentElement.classList.add('focused');
                });
                
                control.addEventListener('blur', function() {
                    if (!this.value) {
                        this.parentElement.classList.remove('focused');
                    }
                });
            });
        });
    </script>
}